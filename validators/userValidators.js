const emailValidator = require("email-validator");const userDB = require('../models/userSchema')module.exports = {    userRegisterValidator: async (req, res, next) => {        const {username, email, photo, password, passwordTwo} = req.body        if (username.length < 4 || username.length > 20) {            return res.send({success: false, message: "Username must be 4 to 20 characters"})        }        const usernameExists = await userDB.findOne({username})        if (usernameExists) return res.send({success: false, message: 'Username exists'})        if (!emailValidator.validate(email)) return res.send({            success: false,            message: 'The value is not a valid email address'        })        const emailExists = await userDB.findOne({email})        if (emailExists) return res.send({success: false, message: "Email exists"})        if (!photo.includes('http')) return res.send({success: false, message: "Photo link should include \"http\""})        if (password.length < 4 || password.length > 25) return res.send({            success: false,            message: "Password must be 4 to 20 characters"        })        if (password !== passwordTwo) return res.send({success: false, message: 'Passwords should match'})        next()    },    userLoginValidation: (req, res, next) => {        const {email, password} = req.body        if (!emailValidator.validate(email)) return res.send({            success: false,            message: 'The value is not a valid email address"'        })        if (password.length < 4 || password.length > 25) return res.send({            success: false,            message: "Password must be 4 to 20 characters"        })        next()    },    userLoggedInValidator: async (req, res, next) => {        const {email} = req.session        if (!email) return res.send({success: false, message: "Please login."})        next()    },    newPasswordValidator: async (req, res, next) => {        const {password, passwordTwo} = req.body        if (4 > password.length) return res.send({success: false, message: 'Password too short'})        if (password.length > 20) return res.send({success: false, message: 'Password too long'})        if (password !== passwordTwo) return res.send({success: false, message: 'Passwords do not match'})        next()    },    validatePhoto: (req, res, next) => {        const {photo} = req.body        if (!photo.includes('http')) return res.send({success: false, message: "Photo link must include \"http\""})        next()    }}